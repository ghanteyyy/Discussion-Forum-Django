{% if trending_rooms %}
    <h3 class="section-title">ðŸ”¥ Trending Now</h3>

    {% for room in trending_rooms %}
        <div class="roomListRoom">
            <div class="roomListRoom__header">
                <a href="{% url 'user-profile' room.host.id %}" class="roomListRoom__author">
                    <div class="avatar avatar--small">
                        <img src="{{room.host.avatar.url}}" />
                    </div>
                    <span>@{{room.host.username}}</span>
                </a>

                <div class="roomListRoom__actions">
                    <span class="score-badge">score: {{ room.score|floatformat:3 }}</span>
                    <span>{{room.created|timesince}} ago</span>
                </div>
            </div>

            <div class="roomListRoom__content">
                <a href="{% url 'room' room.id %}">{{room.name}}</a>
            </div>

            <div class="roomListRoom__meta">
                <a href="{% url 'room' room.id %}" class="roomListRoom__joined">{{room.participants.all.count}} Joined</a>
                <p class="roomListRoom__topic">{{room.topic.name}}</p>
            </div>
        </div>
    {% endfor %}
{% endif %}

{% if request.user.is_authenticated and recommended_rooms %}
    <h3 class="section-title">ðŸŽ¯ Recommended for You</h3>

    {% for room in recommended_rooms %}
        <div class="roomListRoom">
            <div class="roomListRoom__header">
                <a href="{% url 'user-profile' room.host.id %}" class="roomListRoom__author">
                    <div class="avatar avatar--small">
                        <img src="{{room.host.avatar.url}}" />
                    </div>
                    <span>@{{room.host.username}}</span>
                </a>

                <div class="roomListRoom__actions">
                    <span class="score-badge">match: {{ room.score|floatformat:3 }}</span>
                    <span>{{room.created|timesince}} ago</span>
                </div>
            </div>

            <div class="roomListRoom__content">
                <a href="{% url 'room' room.id %}">{{room.name}}</a>
            </div>

            <div class="roomListRoom__meta">
                <a href="{% url 'room' room.id %}" class="roomListRoom__joined">{{room.participants.all.count}} Joined</a>
                <p class="roomListRoom__topic">{{room.topic.name}}</p>
            </div>
        </div>
    {% endfor %}
{% endif %}

<h3 class="section-title">All Rooms</h3>

{% for room in rooms %}
    <div class="roomListRoom">
        <div class="roomListRoom__header">
            <a href="{% url 'user-profile' room.host.id %}" class="roomListRoom__author">
                <div class="avatar avatar--small">
                    <img src="{{room.host.avatar.url}}" />
                </div>
                <span>@{{room.host.username}}</span>
            </a>

            <div class="roomListRoom__actions">
                <span>{{room.created|timesince}} ago</span>
            </div>
        </div>

        <div class="roomListRoom__content">
            <a href="{% url 'room' room.id %}">{{room.name}}</a>
        </div>

        <div class="roomListRoom__meta">
            <a href="{% url 'room' room.id %}" class="roomListRoom__joined">{{room.participants.all.count}} Joined</a>
            <p class="roomListRoom__topic">{{room.topic.name}}</p>
        </div>
    </div>
{% endfor %}

<style>
    .section-title {
        margin: 1.5rem 0 .75rem;
        font-weight: 700;
    }

    .score-badge {
        display: inline-block;
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 999px;
        background: rgba(99, 102, 241, .12);
        border: 1px solid rgba(99, 102, 241, .4);
        margin-right: 8px;
    }
</style>
